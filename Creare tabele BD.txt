CREATE TABLE users (
    id SERIAL PRIMARY KEY,
    firstName VARCHAR(100) NOT NULL CHECK (firstName ~ '^[A-Za-z\- ]+$'),
    lastName VARCHAR(100) NOT NULL CHECK (lastName ~ '^[A-Za-z]+$'),
    email VARCHAR(100) NOT NULL CHECK (email ~* '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\.[A-Za-z]{2,}$'),
    regNum CHAR(5) NOT NULL CHECK (regNum ~ '^[0-9]{5}$'),
    password VARCHAR(100) NOT NULL CHECK (LENGTH(password) >= 3)
);



CREATE TABLE regions (
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);


CREATE TABLE countries(
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    region_id INT,
    FOREIGN KEY (region_id) REFERENCES regions(id)
);

CREATE TABLE provstates(
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    country_id INT,
    FOREIGN KEY (country_id) REFERENCES countries(id)
);

CREATE TABLE cities(
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    provstate_id INT,
    FOREIGN KEY (provstate_id) REFERENCES provstates(id),
    country_id INT,
    FOREIGN KEY (country_id) REFERENCES countries(id),
    lat NUMERIC(9,6) CHECK (lat BETWEEN -90 AND 90),
    long NUMERIC(9,6) CHECK (long BETWEEN -180 AND 180)
);

CREATE TABLE attack(
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL 
);

CREATE TABLE target(
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL
);

CREATE TABLE subtarget(
    id SERIAL PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    target_type INT,
    FOREIGN KEY (target_type) REFERENCES target(id)
);

CREATE TABLE events(
    id SERIAL PRIMARY KEY,
    date DATE NOT NULL,
    city_id INT,
    FOREIGN KEY (city_id) REFERENCES cities(id),
    summary VARCHAR(10000),
    attack_type INT,
    FOREIGN KEY (attack_type) REFERENCES attack(id),
    target_type INT,
    FOREIGN KEY (target_type) REFERENCES target(id),
    subtarget_type INT,
    FOREIGN KEY (subtarget_type) REFERENCES subtarget(id),
    corp VARCHAR(1000),
    spec_target VARCHAR(1000),
    criminal VARCHAR(1000),
    motive VARCHAR(10000)
);